{"ast":null,"code":"var _jsxFileName = \"/home/cadu/projeto_SPR/frontend/src/components/WhatsApp/MessageComposer.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { MicrophoneIcon, StopIcon, SparklesIcon, PaperAirplaneIcon, ClockIcon } from '@heroicons/react/24/outline';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MessageComposer = ({\n  onSendMessage,\n  onScheduleMessage,\n  contactName,\n  isGroup = false,\n  selectedContacts = []\n}) => {\n  _s();\n  const [message, setMessage] = useState('');\n  const [isRecording, setIsRecording] = useState(false);\n  const [showAIHelper, setShowAIHelper] = useState(false);\n  const [showScheduler, setShowScheduler] = useState(false);\n  const [showVariations, setShowVariations] = useState(false);\n  const [messageTone, setMessageTone] = useState('normal');\n  const [aiPrompt, setAiPrompt] = useState('');\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [scheduleDate, setScheduleDate] = useState('');\n  const [scheduleTime, setScheduleTime] = useState('');\n  const [variations, setVariations] = useState([]);\n  const [apiError, setApiError] = useState(null);\n  const [apiSuccess, setApiSuccess] = useState(null);\n  const mediaRecorder = useRef(null);\n  const audioChunks = useRef([]);\n\n  // URL base da API\n  const API_BASE_URL = 'http://localhost:3002';\n\n  // Fun√ß√£o para limpar mensagens de status\n  const clearStatusMessages = () => {\n    setTimeout(() => {\n      setApiError(null);\n      setApiSuccess(null);\n    }, 5000);\n  };\n\n  // Fun√ß√£o para gerar mensagem com IA\n  const generateMessage = async () => {\n    if (!aiPrompt.trim()) {\n      setApiError('Por favor, descreva o que voc√™ quer dizer');\n      clearStatusMessages();\n      return;\n    }\n    setIsGenerating(true);\n    setApiError(null);\n    setApiSuccess(null);\n    try {\n      console.log('ü§ñ Enviando prompt para IA:', {\n        prompt: aiPrompt,\n        tone: messageTone,\n        contactName,\n        isGroup\n      });\n      const response = await fetch(`${API_BASE_URL}/api/generate-message`, {\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          prompt: aiPrompt.trim(),\n          tone: messageTone,\n          contactName: contactName,\n          isGroup: isGroup,\n          context: 'whatsapp'\n        })\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        const errorData = data;\n        throw new Error(errorData.error || `Erro HTTP: ${response.status}`);\n      }\n      const successData = data;\n      if (successData.success && successData.message) {\n        setMessage(successData.message);\n        setAiPrompt('');\n        setShowAIHelper(false);\n        setApiSuccess('‚úÖ Mensagem gerada com sucesso!');\n        console.log('‚úÖ Mensagem gerada:', successData);\n      } else {\n        throw new Error('Resposta inv√°lida da API');\n      }\n    } catch (error) {\n      console.error('‚ùå Erro ao gerar mensagem:', error);\n      let errorMessage = 'Erro desconhecido';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      }\n\n      // Verificar se √© erro de conectividade\n      if (errorMessage.includes('fetch')) {\n        errorMessage = 'N√£o foi poss√≠vel conectar ao servidor. Verifique se o backend est√° rodando na porta 3002.';\n      }\n      setApiError(`‚ùå ${errorMessage}`);\n\n      // Fallback para mensagem simples\n      const fallbackMessage = generateFallbackMessage();\n      setMessage(fallbackMessage);\n      setAiPrompt('');\n      setShowAIHelper(false);\n      setApiError(null);\n      setApiSuccess('‚ö†Ô∏è Usando modo offline - mensagem gerada localmente');\n    } finally {\n      setIsGenerating(false);\n      clearStatusMessages();\n    }\n  };\n\n  // Fun√ß√£o de fallback para gerar mensagem simples\n  const generateFallbackMessage = () => {\n    const toneMessages = {\n      formal: `Prezado(a) ${getContactName()}, espero que esteja bem. `,\n      normal: `Ol√° ${getContactName()}, `,\n      informal: `Oi ${getContactName()}, `,\n      alegre: `Oi ${getContactName()}! üòä `\n    };\n    const baseMessage = toneMessages[messageTone];\n    const promptWords = aiPrompt.toLowerCase().split(' ');\n    if (promptWords.includes('reuni√£o') || promptWords.includes('meeting')) {\n      return baseMessage + 'Gostaria de agendar uma reuni√£o para conversarmos melhor.';\n    }\n    if (promptWords.includes('obrigado') || promptWords.includes('agradec')) {\n      return baseMessage + 'Muito obrigado pela aten√ß√£o!';\n    }\n    if (promptWords.includes('desculp')) {\n      return baseMessage + 'Pe√ßo desculpas pelo inconveniente.';\n    }\n    if (promptWords.includes('pre√ßo') || promptWords.includes('cota√ß√£o')) {\n      return baseMessage + 'Posso te ajudar com informa√ß√µes sobre pre√ßos de commodities.';\n    }\n    return baseMessage + aiPrompt;\n  };\n\n  // Fun√ß√£o para obter nome do contato baseado no tom\n  const getContactName = () => {\n    if (!contactName) return 'cliente';\n    if (messageTone === 'formal') {\n      return contactName.includes(' ') ? `Sr./Sra. ${contactName.split(' ')[0]}` : `Sr./Sra. ${contactName}`;\n    }\n    return contactName.split(' ')[0]; // Apenas primeiro nome\n  };\n\n  // Fun√ß√£o para gerar varia√ß√µes da mensagem\n  const generateVariations = async () => {\n    if (!message.trim()) {\n      setApiError('Primeiro gere ou digite uma mensagem');\n      clearStatusMessages();\n      return;\n    }\n    setIsGenerating(true);\n    setApiError(null);\n    setApiSuccess(null);\n    try {\n      console.log('üîÑ Gerando varia√ß√µes:', {\n        originalMessage: message,\n        tone: messageTone\n      });\n      const response = await fetch(`${API_BASE_URL}/api/generate-variations`, {\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          originalMessage: message,\n          tone: messageTone,\n          count: 3\n        })\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        const errorData = data;\n        throw new Error(errorData.error || `Erro HTTP: ${response.status}`);\n      }\n      const successData = data;\n      if (successData.success && successData.variations) {\n        setVariations(successData.variations);\n        setShowVariations(true);\n        setApiSuccess('‚úÖ Varia√ß√µes geradas com sucesso!');\n        console.log('‚úÖ Varia√ß√µes geradas:', successData);\n      } else {\n        throw new Error('Resposta inv√°lida da API');\n      }\n    } catch (error) {\n      console.error('‚ùå Erro ao gerar varia√ß√µes:', error);\n      setApiError('‚ùå Erro ao gerar varia√ß√µes. Tente novamente.');\n    } finally {\n      setIsGenerating(false);\n      clearStatusMessages();\n    }\n  };\n\n  // Fun√ß√£o para testar conectividade da API\n  const testAPI = async () => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/health`, {\n        method: 'GET',\n        mode: 'cors',\n        headers: {\n          'Accept': 'application/json'\n        }\n      });\n      if (response.ok) {\n        setApiSuccess('‚úÖ Backend conectado e funcionando!');\n      } else {\n        setApiError('‚ùå Backend n√£o est√° respondendo corretamente');\n      }\n    } catch (error) {\n      console.error('Erro de conectividade:', error);\n      setApiError('‚ùå N√£o foi poss√≠vel conectar ao servidor. Verifique se o backend est√° rodando na porta 3002.');\n    }\n    clearStatusMessages();\n  };\n\n  // Fun√ß√£o para selecionar varia√ß√£o\n  const selectVariation = variation => {\n    setMessage(variation);\n    setShowVariations(false);\n    setVariations([]);\n  };\n\n  // Fun√ß√£o para agendar mensagem\n  const handleScheduleMessage = () => {\n    if (!message.trim()) {\n      setApiError('Digite uma mensagem antes de agendar');\n      clearStatusMessages();\n      return;\n    }\n    const scheduleDateTime = new Date(`${scheduleDate}T${scheduleTime}`);\n    if (scheduleDateTime <= new Date()) {\n      setApiError('Data/hora deve ser futura');\n      clearStatusMessages();\n      return;\n    }\n    onScheduleMessage(message, scheduleDateTime);\n    setMessage('');\n    setScheduleDate('');\n    setScheduleTime('');\n    setShowScheduler(false);\n    setApiSuccess('‚úÖ Mensagem agendada com sucesso!');\n    clearStatusMessages();\n  };\n\n  // Fun√ß√£o para gravar √°udio\n  const startRecording = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: true\n      });\n      mediaRecorder.current = new MediaRecorder(stream);\n      audioChunks.current = [];\n      mediaRecorder.current.ondataavailable = event => {\n        audioChunks.current.push(event.data);\n      };\n      mediaRecorder.current.onstop = () => {\n        const audioBlob = new Blob(audioChunks.current, {\n          type: 'audio/wav'\n        });\n        // Aqui voc√™ pode implementar convers√£o de √°udio para texto\n        setApiSuccess('‚úÖ √Åudio gravado! (Convers√£o para texto em desenvolvimento)');\n        clearStatusMessages();\n      };\n      mediaRecorder.current.start();\n      setIsRecording(true);\n    } catch (error) {\n      setApiError('‚ùå Erro ao acessar microfone');\n      clearStatusMessages();\n    }\n  };\n  const stopRecording = () => {\n    if (mediaRecorder.current && isRecording) {\n      mediaRecorder.current.stop();\n      setIsRecording(false);\n    }\n  };\n\n  // Fun√ß√£o para enviar mensagem\n  const handleSendMessage = () => {\n    if (message.trim()) {\n      onSendMessage(message.trim(), 'text');\n      setMessage('');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow-lg p-6\",\n    children: [apiError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\",\n      children: apiError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 9\n    }, this), apiSuccess && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded\",\n      children: apiSuccess\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 9\n    }, this), showAIHelper && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg p-6 w-full max-w-md\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\uD83E\\uDD16 Assistente de IA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowAIHelper(false),\n            className: \"text-gray-500 hover:text-gray-700\",\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"Tom da mensagem:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: messageTone,\n              onChange: e => setMessageTone(e.target.value),\n              className: \"w-full p-2 border border-gray-300 rounded-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"formal\",\n                children: \"Formal (Sr./Sra.)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"normal\",\n                children: \"Normal (Ol\\xE1)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"informal\",\n                children: \"Informal (Oi)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"alegre\",\n                children: \"Alegre (Oi! \\uD83D\\uDE0A)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 402,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"O que voc\\xEA quer dizer?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: aiPrompt,\n              onChange: e => setAiPrompt(e.target.value),\n              placeholder: \"Ex: quero agendar reuni\\xE3o sobre soja\",\n              className: \"w-full p-2 border border-gray-300 rounded-md h-20\",\n              maxLength: 500\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-500 mt-1\",\n              children: [aiPrompt.length, \"/500 caracteres\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Exemplos:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"mt-1 space-y-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"\\u2022 \\\"agendar reuni\\xE3o sobre soja\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 427,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"\\u2022 \\\"cota\\xE7\\xE3o do milho hoje\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"\\u2022 \\\"agradecer pelo contato\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"\\u2022 \\\"proposta comercial\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 430,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: testAPI,\n              className: \"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm\",\n              children: \"Testar API\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: generateMessage,\n              disabled: isGenerating,\n              className: \"flex-1 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50\",\n              children: isGenerating ? 'Gerando...' : 'Gerar Mensagem'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 9\n    }, this), showVariations && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg p-6 w-full max-w-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\uD83D\\uDD04 Varia\\xE7\\xF5es da Mensagem\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowVariations(false),\n            className: \"text-gray-500 hover:text-gray-700\",\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: variations.map((variation, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 border border-gray-200 rounded cursor-pointer hover:bg-gray-50\",\n            onClick: () => selectVariation(variation),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-600 mb-1\",\n              children: [\"Varia\\xE7\\xE3o \", index + 1]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 476,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-gray-800\",\n              children: variation\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 471,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 9\n    }, this), showScheduler && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg p-6 w-full max-w-md\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold\",\n            children: \"\\u23F0 Agendar Mensagem\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 492,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowScheduler(false),\n            className: \"text-gray-500 hover:text-gray-700\",\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"Data:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 503,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: scheduleDate,\n              onChange: e => setScheduleDate(e.target.value),\n              className: \"w-full p-2 border border-gray-300 rounded-md\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 506,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"Hora:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"time\",\n              value: scheduleTime,\n              onChange: e => setScheduleTime(e.target.value),\n              className: \"w-full p-2 border border-gray-300 rounded-md\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 518,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 514,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleScheduleMessage,\n            className: \"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\",\n            children: \"Agendar Mensagem\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-end space-x-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          placeholder: \"Digite sua mensagem...\",\n          className: \"w-full p-3 border border-gray-300 rounded-lg resize-none\",\n          rows: 3,\n          maxLength: 1000\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 mt-1\",\n          children: [message.length, \"/1000 caracteres\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 548,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 539,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowAIHelper(true),\n          className: \"p-2 bg-purple-500 text-white rounded hover:bg-purple-600\",\n          title: \"Assistente de IA\",\n          children: /*#__PURE__*/_jsxDEV(SparklesIcon, {\n            className: \"w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this), message.trim() && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: generateVariations,\n          disabled: isGenerating,\n          className: \"p-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50\",\n          title: \"Gerar varia\\xE7\\xF5es\",\n          children: \"\\uD83D\\uDD04\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: isRecording ? stopRecording : startRecording,\n          className: `p-2 rounded ${isRecording ? 'bg-red-500 text-white hover:bg-red-600' : 'bg-gray-500 text-white hover:bg-gray-600'}`,\n          title: isRecording ? 'Parar grava√ß√£o' : 'Gravar √°udio',\n          children: isRecording ? /*#__PURE__*/_jsxDEV(StopIcon, {\n            className: \"w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(MicrophoneIcon, {\n            className: \"w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 588,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowScheduler(true),\n          className: \"p-2 bg-orange-500 text-white rounded hover:bg-orange-600\",\n          title: \"Agendar mensagem\",\n          children: /*#__PURE__*/_jsxDEV(ClockIcon, {\n            className: \"w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 598,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSendMessage,\n          disabled: !message.trim(),\n          className: \"p-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50\",\n          title: \"Enviar mensagem\",\n          children: /*#__PURE__*/_jsxDEV(PaperAirplaneIcon, {\n            className: \"w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 608,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 538,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 361,\n    columnNumber: 5\n  }, this);\n};\n_s(MessageComposer, \"mxSZ2ijr+1z2xUa8wzZ6exStLV0=\");\n_c = MessageComposer;\nexport default MessageComposer;\nvar _c;\n$RefreshReg$(_c, \"MessageComposer\");","map":{"version":3,"names":["React","useState","useRef","MicrophoneIcon","StopIcon","SparklesIcon","PaperAirplaneIcon","ClockIcon","jsxDEV","_jsxDEV","MessageComposer","onSendMessage","onScheduleMessage","contactName","isGroup","selectedContacts","_s","message","setMessage","isRecording","setIsRecording","showAIHelper","setShowAIHelper","showScheduler","setShowScheduler","showVariations","setShowVariations","messageTone","setMessageTone","aiPrompt","setAiPrompt","isGenerating","setIsGenerating","scheduleDate","setScheduleDate","scheduleTime","setScheduleTime","variations","setVariations","apiError","setApiError","apiSuccess","setApiSuccess","mediaRecorder","audioChunks","API_BASE_URL","clearStatusMessages","setTimeout","generateMessage","trim","console","log","prompt","tone","response","fetch","method","mode","headers","body","JSON","stringify","context","data","json","ok","errorData","Error","error","status","successData","success","errorMessage","includes","fallbackMessage","generateFallbackMessage","toneMessages","formal","getContactName","normal","informal","alegre","baseMessage","promptWords","toLowerCase","split","generateVariations","originalMessage","count","testAPI","selectVariation","variation","handleScheduleMessage","scheduleDateTime","Date","startRecording","stream","navigator","mediaDevices","getUserMedia","audio","current","MediaRecorder","ondataavailable","event","push","onstop","audioBlob","Blob","type","start","stopRecording","stop","handleSendMessage","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","value","onChange","e","target","placeholder","maxLength","length","disabled","map","index","rows","title","_c","$RefreshReg$"],"sources":["/home/cadu/projeto_SPR/frontend/src/components/WhatsApp/MessageComposer.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { \r\n  MicrophoneIcon, \r\n  StopIcon, \r\n  SparklesIcon, \r\n  PaperAirplaneIcon,\r\n  AdjustmentsHorizontalIcon,\r\n  UserGroupIcon,\r\n  ClockIcon,\r\n  ExclamationTriangleIcon,\r\n  CheckCircleIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { WhatsAppContact } from '../../types';\r\n\r\ninterface MessageComposerProps {\r\n  contacts?: WhatsAppContact[];\r\n  onSendMessage: (message: string, type: 'text' | 'audio') => void;\r\n  onScheduleMessage: (message: string, scheduleTime: Date) => void;\r\n  contactName?: string;\r\n  isGroup?: boolean;\r\n  selectedContacts?: string[];\r\n}\r\n\r\ntype MessageTone = 'formal' | 'normal' | 'informal' | 'alegre';\r\n\r\ninterface APIResponse {\r\n  success: boolean;\r\n  message: string;\r\n  tone: string;\r\n  timestamp: string;\r\n  metadata?: {\r\n    generationId: string;\r\n    length: number;\r\n    wordsCount: number;\r\n  };\r\n}\r\n\r\ninterface VariationsResponse {\r\n  success: boolean;\r\n  variations: string[];\r\n  originalMessage: string;\r\n  tone: string;\r\n  count: number;\r\n  timestamp: string;\r\n}\r\n\r\nconst MessageComposer: React.FC<MessageComposerProps> = ({\r\n  onSendMessage,\r\n  onScheduleMessage,\r\n  contactName,\r\n  isGroup = false,\r\n  selectedContacts = []\r\n}) => {\r\n  const [message, setMessage] = useState('');\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [showAIHelper, setShowAIHelper] = useState(false);\r\n  const [showScheduler, setShowScheduler] = useState(false);\r\n  const [showVariations, setShowVariations] = useState(false);\r\n  const [messageTone, setMessageTone] = useState<MessageTone>('normal');\r\n  const [aiPrompt, setAiPrompt] = useState('');\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [scheduleDate, setScheduleDate] = useState('');\r\n  const [scheduleTime, setScheduleTime] = useState('');\r\n  const [variations, setVariations] = useState<string[]>([]);\r\n  const [apiError, setApiError] = useState<string | null>(null);\r\n  const [apiSuccess, setApiSuccess] = useState<string | null>(null);\r\n  \r\n  const mediaRecorder = useRef<MediaRecorder | null>(null);\r\n  const audioChunks = useRef<Blob[]>([]);\r\n\r\n  // URL base da API\r\n  const API_BASE_URL = 'http://localhost:3002';\r\n\r\n  // Fun√ß√£o para limpar mensagens de status\r\n  const clearStatusMessages = () => {\r\n    setTimeout(() => {\r\n      setApiError(null);\r\n      setApiSuccess(null);\r\n    }, 5000);\r\n  };\r\n\r\n  // Fun√ß√£o para gerar mensagem com IA\r\n  const generateMessage = async () => {\r\n    if (!aiPrompt.trim()) {\r\n      setApiError('Por favor, descreva o que voc√™ quer dizer');\r\n      clearStatusMessages();\r\n      return;\r\n    }\r\n    \r\n    setIsGenerating(true);\r\n    setApiError(null);\r\n    setApiSuccess(null);\r\n    \r\n    try {\r\n      console.log('ü§ñ Enviando prompt para IA:', {\r\n        prompt: aiPrompt,\r\n        tone: messageTone,\r\n        contactName,\r\n        isGroup\r\n      });\r\n\r\n      const response = await fetch(`${API_BASE_URL}/api/generate-message`, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          prompt: aiPrompt.trim(),\r\n          tone: messageTone,\r\n          contactName: contactName,\r\n          isGroup: isGroup,\r\n          context: 'whatsapp'\r\n        }),\r\n      });\r\n\r\n      const data: APIResponse | { error: string; code: string } = await response.json();\r\n\r\n      if (!response.ok) {\r\n        const errorData = data as { error: string; code: string };\r\n        throw new Error(errorData.error || `Erro HTTP: ${response.status}`);\r\n      }\r\n\r\n      const successData = data as APIResponse;\r\n      \r\n      if (successData.success && successData.message) {\r\n        setMessage(successData.message);\r\n        setAiPrompt('');\r\n        setShowAIHelper(false);\r\n        setApiSuccess('‚úÖ Mensagem gerada com sucesso!');\r\n        console.log('‚úÖ Mensagem gerada:', successData);\r\n      } else {\r\n        throw new Error('Resposta inv√°lida da API');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Erro ao gerar mensagem:', error);\r\n      \r\n      let errorMessage = 'Erro desconhecido';\r\n      if (error instanceof Error) {\r\n        errorMessage = error.message;\r\n      }\r\n      \r\n      // Verificar se √© erro de conectividade\r\n      if (errorMessage.includes('fetch')) {\r\n        errorMessage = 'N√£o foi poss√≠vel conectar ao servidor. Verifique se o backend est√° rodando na porta 3002.';\r\n      }\r\n      \r\n      setApiError(`‚ùå ${errorMessage}`);\r\n      \r\n      // Fallback para mensagem simples\r\n      const fallbackMessage = generateFallbackMessage();\r\n      setMessage(fallbackMessage);\r\n      setAiPrompt('');\r\n      setShowAIHelper(false);\r\n      setApiError(null);\r\n      setApiSuccess('‚ö†Ô∏è Usando modo offline - mensagem gerada localmente');\r\n      \r\n    } finally {\r\n      setIsGenerating(false);\r\n      clearStatusMessages();\r\n    }\r\n  };\r\n\r\n  // Fun√ß√£o de fallback para gerar mensagem simples\r\n  const generateFallbackMessage = () => {\r\n    const toneMessages = {\r\n      formal: `Prezado(a) ${getContactName()}, espero que esteja bem. `,\r\n      normal: `Ol√° ${getContactName()}, `,\r\n      informal: `Oi ${getContactName()}, `,\r\n      alegre: `Oi ${getContactName()}! üòä `\r\n    };\r\n\r\n    const baseMessage = toneMessages[messageTone];\r\n    const promptWords = aiPrompt.toLowerCase().split(' ');\r\n    \r\n    if (promptWords.includes('reuni√£o') || promptWords.includes('meeting')) {\r\n      return baseMessage + 'Gostaria de agendar uma reuni√£o para conversarmos melhor.';\r\n    }\r\n    if (promptWords.includes('obrigado') || promptWords.includes('agradec')) {\r\n      return baseMessage + 'Muito obrigado pela aten√ß√£o!';\r\n    }\r\n    if (promptWords.includes('desculp')) {\r\n      return baseMessage + 'Pe√ßo desculpas pelo inconveniente.';\r\n    }\r\n    if (promptWords.includes('pre√ßo') || promptWords.includes('cota√ß√£o')) {\r\n      return baseMessage + 'Posso te ajudar com informa√ß√µes sobre pre√ßos de commodities.';\r\n    }\r\n    \r\n    return baseMessage + aiPrompt;\r\n  };\r\n\r\n  // Fun√ß√£o para obter nome do contato baseado no tom\r\n  const getContactName = () => {\r\n    if (!contactName) return 'cliente';\r\n    \r\n    if (messageTone === 'formal') {\r\n      return contactName.includes(' ') \r\n        ? `Sr./Sra. ${contactName.split(' ')[0]}`\r\n        : `Sr./Sra. ${contactName}`;\r\n    }\r\n    \r\n    return contactName.split(' ')[0]; // Apenas primeiro nome\r\n  };\r\n\r\n  // Fun√ß√£o para gerar varia√ß√µes da mensagem\r\n  const generateVariations = async () => {\r\n    if (!message.trim()) {\r\n      setApiError('Primeiro gere ou digite uma mensagem');\r\n      clearStatusMessages();\r\n      return;\r\n    }\r\n    \r\n    setIsGenerating(true);\r\n    setApiError(null);\r\n    setApiSuccess(null);\r\n    \r\n    try {\r\n      console.log('üîÑ Gerando varia√ß√µes:', {\r\n        originalMessage: message,\r\n        tone: messageTone\r\n      });\r\n\r\n      const response = await fetch(`${API_BASE_URL}/api/generate-variations`, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          originalMessage: message,\r\n          tone: messageTone,\r\n          count: 3\r\n        }),\r\n      });\r\n\r\n      const data: VariationsResponse | { error: string; code: string } = await response.json();\r\n\r\n      if (!response.ok) {\r\n        const errorData = data as { error: string; code: string };\r\n        throw new Error(errorData.error || `Erro HTTP: ${response.status}`);\r\n      }\r\n\r\n      const successData = data as VariationsResponse;\r\n      \r\n      if (successData.success && successData.variations) {\r\n        setVariations(successData.variations);\r\n        setShowVariations(true);\r\n        setApiSuccess('‚úÖ Varia√ß√µes geradas com sucesso!');\r\n        console.log('‚úÖ Varia√ß√µes geradas:', successData);\r\n      } else {\r\n        throw new Error('Resposta inv√°lida da API');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Erro ao gerar varia√ß√µes:', error);\r\n      setApiError('‚ùå Erro ao gerar varia√ß√µes. Tente novamente.');\r\n    } finally {\r\n      setIsGenerating(false);\r\n      clearStatusMessages();\r\n    }\r\n  };\r\n\r\n  // Fun√ß√£o para testar conectividade da API\r\n  const testAPI = async () => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/api/health`, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n        },\r\n      });\r\n      if (response.ok) {\r\n        setApiSuccess('‚úÖ Backend conectado e funcionando!');\r\n      } else {\r\n        setApiError('‚ùå Backend n√£o est√° respondendo corretamente');\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro de conectividade:', error);\r\n      setApiError('‚ùå N√£o foi poss√≠vel conectar ao servidor. Verifique se o backend est√° rodando na porta 3002.');\r\n    }\r\n    clearStatusMessages();\r\n  };\r\n\r\n  // Fun√ß√£o para selecionar varia√ß√£o\r\n  const selectVariation = (variation: string) => {\r\n    setMessage(variation);\r\n    setShowVariations(false);\r\n    setVariations([]);\r\n  };\r\n\r\n  // Fun√ß√£o para agendar mensagem\r\n  const handleScheduleMessage = () => {\r\n    if (!message.trim()) {\r\n      setApiError('Digite uma mensagem antes de agendar');\r\n      clearStatusMessages();\r\n      return;\r\n    }\r\n\r\n    const scheduleDateTime = new Date(`${scheduleDate}T${scheduleTime}`);\r\n    if (scheduleDateTime <= new Date()) {\r\n      setApiError('Data/hora deve ser futura');\r\n      clearStatusMessages();\r\n      return;\r\n    }\r\n\r\n    onScheduleMessage(message, scheduleDateTime);\r\n    setMessage('');\r\n    setScheduleDate('');\r\n    setScheduleTime('');\r\n    setShowScheduler(false);\r\n    setApiSuccess('‚úÖ Mensagem agendada com sucesso!');\r\n    clearStatusMessages();\r\n  };\r\n\r\n  // Fun√ß√£o para gravar √°udio\r\n  const startRecording = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      mediaRecorder.current = new MediaRecorder(stream);\r\n      audioChunks.current = [];\r\n\r\n      mediaRecorder.current.ondataavailable = (event) => {\r\n        audioChunks.current.push(event.data);\r\n      };\r\n\r\n      mediaRecorder.current.onstop = () => {\r\n        const audioBlob = new Blob(audioChunks.current, { type: 'audio/wav' });\r\n        // Aqui voc√™ pode implementar convers√£o de √°udio para texto\r\n        setApiSuccess('‚úÖ √Åudio gravado! (Convers√£o para texto em desenvolvimento)');\r\n        clearStatusMessages();\r\n      };\r\n\r\n      mediaRecorder.current.start();\r\n      setIsRecording(true);\r\n    } catch (error) {\r\n      setApiError('‚ùå Erro ao acessar microfone');\r\n      clearStatusMessages();\r\n    }\r\n  };\r\n\r\n  const stopRecording = () => {\r\n    if (mediaRecorder.current && isRecording) {\r\n      mediaRecorder.current.stop();\r\n      setIsRecording(false);\r\n    }\r\n  };\r\n\r\n  // Fun√ß√£o para enviar mensagem\r\n  const handleSendMessage = () => {\r\n    if (message.trim()) {\r\n      onSendMessage(message.trim(), 'text');\r\n      setMessage('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n      {/* Status Messages */}\r\n      {apiError && (\r\n        <div className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\">\r\n          {apiError}\r\n        </div>\r\n      )}\r\n      {apiSuccess && (\r\n        <div className=\"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded\">\r\n          {apiSuccess}\r\n        </div>\r\n      )}\r\n\r\n      {/* AI Helper Modal */}\r\n      {showAIHelper && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"text-lg font-semibold\">ü§ñ Assistente de IA</h3>\r\n              <button\r\n                onClick={() => setShowAIHelper(false)}\r\n                className=\"text-gray-500 hover:text-gray-700\"\r\n              >\r\n                ‚úï\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              {/* Tom da mensagem */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Tom da mensagem:\r\n                </label>\r\n                <select\r\n                  value={messageTone}\r\n                  onChange={(e) => setMessageTone(e.target.value as MessageTone)}\r\n                  className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n                >\r\n                  <option value=\"formal\">Formal (Sr./Sra.)</option>\r\n                  <option value=\"normal\">Normal (Ol√°)</option>\r\n                  <option value=\"informal\">Informal (Oi)</option>\r\n                  <option value=\"alegre\">Alegre (Oi! üòä)</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Prompt */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  O que voc√™ quer dizer?\r\n                </label>\r\n                <textarea\r\n                  value={aiPrompt}\r\n                  onChange={(e) => setAiPrompt(e.target.value)}\r\n                  placeholder=\"Ex: quero agendar reuni√£o sobre soja\"\r\n                  className=\"w-full p-2 border border-gray-300 rounded-md h-20\"\r\n                  maxLength={500}\r\n                />\r\n                <div className=\"text-xs text-gray-500 mt-1\">\r\n                  {aiPrompt.length}/500 caracteres\r\n                </div>\r\n              </div>\r\n\r\n              {/* Exemplos */}\r\n              <div className=\"text-sm text-gray-600\">\r\n                <strong>Exemplos:</strong>\r\n                <ul className=\"mt-1 space-y-1\">\r\n                  <li>‚Ä¢ \"agendar reuni√£o sobre soja\"</li>\r\n                  <li>‚Ä¢ \"cota√ß√£o do milho hoje\"</li>\r\n                  <li>‚Ä¢ \"agradecer pelo contato\"</li>\r\n                  <li>‚Ä¢ \"proposta comercial\"</li>\r\n                </ul>\r\n              </div>\r\n\r\n              {/* Bot√µes */}\r\n              <div className=\"flex space-x-2\">\r\n                <button\r\n                  onClick={testAPI}\r\n                  className=\"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm\"\r\n                >\r\n                  Testar API\r\n                </button>\r\n                <button\r\n                  onClick={generateMessage}\r\n                  disabled={isGenerating}\r\n                  className=\"flex-1 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50\"\r\n                >\r\n                  {isGenerating ? 'Gerando...' : 'Gerar Mensagem'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Variations Modal */}\r\n      {showVariations && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-lg\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"text-lg font-semibold\">üîÑ Varia√ß√µes da Mensagem</h3>\r\n              <button\r\n                onClick={() => setShowVariations(false)}\r\n                className=\"text-gray-500 hover:text-gray-700\"\r\n              >\r\n                ‚úï\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              {variations.map((variation, index) => (\r\n                <div\r\n                  key={index}\r\n                  className=\"p-3 border border-gray-200 rounded cursor-pointer hover:bg-gray-50\"\r\n                  onClick={() => selectVariation(variation)}\r\n                >\r\n                  <div className=\"text-sm text-gray-600 mb-1\">\r\n                    Varia√ß√£o {index + 1}\r\n                  </div>\r\n                  <div className=\"text-gray-800\">{variation}</div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Scheduler Modal */}\r\n      {showScheduler && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"text-lg font-semibold\">‚è∞ Agendar Mensagem</h3>\r\n              <button\r\n                onClick={() => setShowScheduler(false)}\r\n                className=\"text-gray-500 hover:text-gray-700\"\r\n              >\r\n                ‚úï\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Data:\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={scheduleDate}\r\n                  onChange={(e) => setScheduleDate(e.target.value)}\r\n                  className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Hora:\r\n                </label>\r\n                <input\r\n                  type=\"time\"\r\n                  value={scheduleTime}\r\n                  onChange={(e) => setScheduleTime(e.target.value)}\r\n                  className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n                />\r\n              </div>\r\n\r\n              <button\r\n                onClick={handleScheduleMessage}\r\n                className=\"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n              >\r\n                Agendar Mensagem\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Message Input */}\r\n      <div className=\"flex items-end space-x-2\">\r\n        <div className=\"flex-1\">\r\n          <textarea\r\n            value={message}\r\n            onChange={(e) => setMessage(e.target.value)}\r\n            placeholder=\"Digite sua mensagem...\"\r\n            className=\"w-full p-3 border border-gray-300 rounded-lg resize-none\"\r\n            rows={3}\r\n            maxLength={1000}\r\n          />\r\n          <div className=\"text-xs text-gray-500 mt-1\">\r\n            {message.length}/1000 caracteres\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex flex-col space-y-2\">\r\n          {/* AI Helper Button */}\r\n          <button\r\n            onClick={() => setShowAIHelper(true)}\r\n            className=\"p-2 bg-purple-500 text-white rounded hover:bg-purple-600\"\r\n            title=\"Assistente de IA\"\r\n          >\r\n            <SparklesIcon className=\"w-5 h-5\" />\r\n          </button>\r\n\r\n          {/* Variations Button */}\r\n          {message.trim() && (\r\n            <button\r\n              onClick={generateVariations}\r\n              disabled={isGenerating}\r\n              className=\"p-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50\"\r\n              title=\"Gerar varia√ß√µes\"\r\n            >\r\n              üîÑ\r\n            </button>\r\n          )}\r\n\r\n          {/* Record Audio Button */}\r\n          <button\r\n            onClick={isRecording ? stopRecording : startRecording}\r\n            className={`p-2 rounded ${\r\n              isRecording \r\n                ? 'bg-red-500 text-white hover:bg-red-600' \r\n                : 'bg-gray-500 text-white hover:bg-gray-600'\r\n            }`}\r\n            title={isRecording ? 'Parar grava√ß√£o' : 'Gravar √°udio'}\r\n          >\r\n            {isRecording ? (\r\n              <StopIcon className=\"w-5 h-5\" />\r\n            ) : (\r\n              <MicrophoneIcon className=\"w-5 h-5\" />\r\n            )}\r\n          </button>\r\n\r\n          {/* Schedule Button */}\r\n          <button\r\n            onClick={() => setShowScheduler(true)}\r\n            className=\"p-2 bg-orange-500 text-white rounded hover:bg-orange-600\"\r\n            title=\"Agendar mensagem\"\r\n          >\r\n            <ClockIcon className=\"w-5 h-5\" />\r\n          </button>\r\n\r\n          {/* Send Button */}\r\n          <button\r\n            onClick={handleSendMessage}\r\n            disabled={!message.trim()}\r\n            className=\"p-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50\"\r\n            title=\"Enviar mensagem\"\r\n          >\r\n            <PaperAirplaneIcon className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageComposer; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}